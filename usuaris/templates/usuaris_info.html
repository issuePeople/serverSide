
{% extends 'navbar.html' %}

{% block body %}

    <div class="profile centered" style="margin-left: 50px;">
        <section class="profile-bar">
            <div>
                <img src="{{ usuari.avatar.url }}"
                width="200"
                height="200">
            </div>

            <div class="profile-data">
                <h1 class="not-full-name">
                    <p>{{usuari.user.username}}</p>
                </h1>
                <div class="username">
                    <p>@{{usuari.user.username}}</p>
                    
                </div>
            </div>
            <div class="profile-stats">
                <div class ="stat">
                </div>
            </div>
            <div class="profile-quote">
                <span>
                    {% if usuari.bio %}{{usuari.bio}}{% endif %}
                </span>
            </div>
        </section>
        <div class="main">
            <div>
                <div class="taskboard-actions">
                    <table style="width: 40%;border-collapse:separate; border-spacing: 0 5px;">
                        <tr>
                            {% if "?mostrar=watched" in request.get_full_path %}
                                <td>
                                    <th>
                                        <a href="{% url 'usuari' usuari.user.id %}?mostrar=timeline">
                                            <h1><i class="fa fa-align-justify"  aria-hidden="true" ></i> &nbsp Timeline &nbsp </h1>
                                        </a>
                                    </th>
                                </td>
                                <td>
                                    <th>
                                        <a href="{% url 'usuari' usuari.user.id %}?mostrar=watched">
                                            <h1><i class="fa fa-eye" aria-hidden="true"></i> <u>Watched</u></h1>
                                        </a>
                                    </th>
                                </td>
                            {%else%}
                                <td>
                                    <th>
                                        <a href="{% url 'usuari' usuari.user.id %}?mostrar=timeline">
                                            <h1><i class="fa fa-align-justify"  aria-hidden="true" ></i> &nbsp <u>Timeline</u> &nbsp </h1>
                                        </a>
                                    </th>
                                </td>
                                <td>
                                    <th>
                                        <a href="{% url 'usuari' usuari.user.id %}?mostrar=watched">
                                            <h1><i class="fa fa-eye" aria-hidden="true"></i> Watched</h1>
                                        </a>
                                    </th>
                                </td>
                            {%endif%}
                        </tr>
                    </table>
                </div>
                <p style="color:darkgrey" >__________________________________________________________________________________________</p>
                <!--Hacer bucle recorrriendo-->
                {% if "?mostrar=watched" in request.get_full_path %}
                <section class="watched">
                    <table class="issues-table" style="width: 100%;border-collapse:separate; border-spacing: 0 10px;" >
                        {% for observat in usuari.observats.all %}
                            <tr >
                                <td>
                                    <p>
                                        {% if observat.assignacio.length == 0 %}
                                        <img src="{{ NO_AVATAR_URL }}" style="width: 48px; height: 48px;"> 
                                        {% else %}
                                        <img src="{{ observat.assignacio.avatar.url }}" style="width: 48px; height: 48px;"> 
                                        {% endif %}
                                        {{observat.assignacio.user}} <a href="{% url 'editar_issue' observat.id %}">#{{observat.id}} {{observat.subject}}</a> {{observat.get_estat_display}}
                                    </p>
                                    <p></p>
                                    <p style="color:darkgrey">__________________________________________________________________________________________</p>
                                </td> 
                            </tr> 
                        {% endfor %}
                    </table>
                </section>
                {%else%}
                <section class ="timeline">
                    <div class="issue-page"style="width: 100%; ">
                        <table class="issues-table" style="width: 100%;border-collapse:separate; border-spacing: 0 10px;" > 
                            {% for log in logs %}
                                <tr class="row table-main">
                                    <!--Ojo hardcoded-->
                                    <p><img src="{{ usuari.avatar.url }}" style="width: 32px; height: 32px;"><a href="{% url 'usuari' log.usuari.user.id %}"> {{log.usuari.user}}</a>
                                    {% if log.tipus == "Creada" %}
                                        ha creat l'
                                    {% elif log.tipus == 'Nou attachment' %}
                                        ha afegit el fitxer <a>{{log.valor_nou}}</a> al
                                    {% elif log.tipus == "Attachment esborrat" %}
                                        ha esborrat el fitxer {{log.valor_antic}} al
                                    {% elif log.tipus == "Tag afegida" %}
                                        ha afegit el tag {{log.valor_nou}} al
                                    {% elif log.tipus == "Tag esborrada" %}
                                        ha esborrat el tag {{log.valor_antic}} al
                                    {% else %}
                                        ha canviat l'atribut {{log.tipus}}  de {{log.valor_previ}} a {{log.valor_nou}} del
                                    {%endif%}
                                    issue {% if log.issue %}<a href="{% url 'editar_issue' log.issue.id %}">#{{log.issue.id}} {{log.issue.subject}}</a>{% endif %}</p>
                                    <p style="color:darkgrey">{{log.data}}</p>
                                    <p style="color:darkgrey">__________________________________________________________________________________________</p>
                                </tr> 
                            {% endfor %}
                        </table>
                    </div>
                </section>  
                {%endif%}
            </div>
        </div>
    </div>
</body>



{% endblock %}