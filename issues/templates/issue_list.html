
{% extends 'navbar.html' %}

{% block body %}

<div class="master" style>
    <div class = "wrapper issues lightbox-generic-form">
        <div class="main issue-main">
            <div class="issue-top">
                <header class="issue-header">
                    <h1>
                        <span>Issues</span>
                        
                    </h1>
                    <div class="taskboard-actions">
                        <div class="issue-table-options-start" >
                            <button class="btn-filter" onclick="myFunction()">
                                <i class="fa fa-sliders" aria-hidden="true"></i>
                                
                                <span class="text" style="margin: 5px;">Filtres</span>
                            </button>
                            <!--Busqueda -->
                            <div style="display: flex; flex-direction:row;padding-left: 10px;">
                                <input id="busca" type="search" placeholder="Buscar" class="ng-pristine ng-valid ng-empty ng-touched">
                                <button type="sumbit" onclick="filtre('search=','busca')">
                                    <i class="fa fa-search" aria-hidden="true"></i>
                                </button>
                            </div>
                            <!--Toggle Tags-->
                            <div style="display:flex; flex-direction:row; padding-left:10px">
                                <div onclick="toggle()" style="padding-right:10px">
                                    <div  id="tag_on">
                                        <i class="fa fa-toggle-on" aria-hidden="true" style="color:#008aa8"></i>
                                    </div>
                                    <div  id="tag_off" style="display:none">
                                        <i class="fa fa-toggle-off" aria-hidden="true"></i>
                                    </div>
                                </div>
                                <span>Tags</span>
                            </div>
                        </div>
                        <div class="new-issue">
                            <button class="btn-small" >
                                <span class="icon icon-add" style="font-size: large;padding-right: 5px;">+</span>
                                <a href="{% url 'crear_issue' %}" > New Issue</a>
                            </button>
                            
                            <button class="btn-icon" >
                                
                                    <a href="{% url 'bulk_issue'%}" >
                                        <i class="fa fa-plus" aria-hidden="true"></i>  
                                    </a> 

                                
                                
                            </button>
                        </div>
                        
                    </div>
                </header>
            </div>
            <div class="issue-container">
                
                <sidebar class="filters-bar" id="filtres"  >
                    <div>
                        <div class="filters-step-cat">
                           
                            <div class="filters-cat">
                                <div class="filters-applied">
                                    <div class="filters-included">
                                        <div class="filters-title">Filtrat per:</div>
                                        <div class="filters-wrapper">
                                            {%for key,value in TTipus%}
                                            <!--<form method="delete" action="{{request.GET.tipus}}">
                                                <div name="tipus" value="{{key}}" class="single-applied-filter ng-animate-disabled include">
                                                    <div class="name">{{value}}</div>
                                                </div>
                                                <button type="submit" >X</button>
                                            </form>-->
                                            
                                            {% if key in request.GET.tipus %}
                                            {%with "?tipus="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include" >
                                                <div class="name">{{value}}</div>
                                 
                                                    <a href="{{link}}" class="name" onclick="borra()">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%elif "&tipus="|add:key in request.get_full_path%}
                                            
                                            {%with "&tipus="|add:key as patata%}
                                            <p>{{patata}}</p>
                                            {%with request.get_full_path|cut:patata as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                        
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            
                                            {%for key,value in TGravetat%}
                                            {% if key in request.GET.gravetat %}
                                            {%with "?gravetat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                                <a href="{{link}}" class="name">X</a>
                                            {%endwith%}
                                            {%endwith%}
                                            </div>
                                            
                                            {%elif "&gravetat="|add:key in request.get_full_path%}
                                            {%with "&gravetat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                           
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            
                                            {%for key,value in TPrioritat%}
                                            {% if key in request.GET.prioritat %}
                                            {%with "?prioritat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include" id="bug_select">
                                                    <div class="name">{{value}}</div>
                                                    <a href="?prioritat=" class="name"onclick="filtrat('bug')">X</a>
                                                    {%endwith%}
                                               {%endwith%}
                                            </div>
                                            {%elif "&prioritat="|add:key in request.get_full_path%}
                                            {%with "&prioritat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                           
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            
                                            {%for key,value in TEstats%}
                                            {% if key in request.GET.estat %}
                                            {%with "?estat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include" id="bug_select">
                                                    <div class="name">{{value}}</div>
                                                    <a href="?estat=" class="name">X</a>
                                                    {%endwith%}
                                               {%endwith%}
                                            </div>
                                            {%elif "&estat="|add:key in request.get_full_path%}
                                            {%with "&estat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                           
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            
                                            {%for usuari in usuaris%}
                                            {% if usuari.user.username in request.GET.assignat %}
                                            {%with "?assignat="|add:usuari.user.username as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include" id="bug_select">
                                                    <div class="name">{{usuari.user.username}}</div>
                                                    <a href="?assignat=" class="name">X</a>
                                                    {%endwith%}
                                               {%endwith%}
                                            </div>
                                            {%elif "&assignat="|add:usuari.user.username in request.get_full_path%}
                                            {%with "&assignat="|add:usuari.user.username as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{usuari.user.username}}</div>
                                           
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            {%for issue in issues%}
                                      
                                            {%for tag in issue.tags.all%}
                                           
                                            {% if tag.nom in request.GET.tags %}
                                            {%with "?tags="|add:tag.nom as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <button class="single-applied-filter ng-animate-disabled include"style="background-color: {{tag.color}};">
                                                    <div class="name" style="background-color: {{tag.color}};">{{tag.nom}}</div>
                                                    <a href="{{link}}" class="name">X</a>
                                                    {%endwith%}
                                               {%endwith%}
                                            </button>
                                            {%elif "&tags="|add:tag.nom in request.get_full_path%}
                                            {%with "&tags="|add:tag.nom as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include">
                                                <div class="name">{{value}}</div>
                                           
                                                    <a href="{{link}}" class="name">X</a>
                                               {%endwith%}
                                               {%endwith%}
                                                
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                            {%endfor%}
                                            
                                            {%for usuari in usuaris%}
                                            {% if usuari.user.username in request.GET.creat %}
                                            {%with "?creat="|add:key as parametre%}
                                            {%with request.get_full_path|cut:parametre as link%}
                                            <div class="single-applied-filter ng-animate-disabled include" >
                                                    <div class="name">{{usuari.user.username}}</div>
                                                    <a href="{{link}}" class="name">X</a>
                                                    {%endwith%}
                                               {%endwith%}
                                            </div>
                                            {%endif%}
                                            {%endfor%}
                                        </div>
                                    </div>
                                </div>
                                <!--Llistat Filtres-->
                                <ul>
                                    <li> <!--Tipus-->
                                        <button class="filters-cat-single"  id="categoria_filtre_tipus" name = "obre"onclick="filtre_tipus('filtre_tipus')" style="display: flex">
                                            <span>Tipus</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: block">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_tipus_selected" onclick="filtre_tipus('filtre_tipus')" style="display: none">
                                            <span>Tipus</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none"  name="tanca"  id="filtre_tipus" style="display:flex ; flex-direction: column";>
                                            <div>
                                                {%for key,value in TTipus%}
                                                    {%if key == 'B'%}
                                                        <button class="single-filter single-filter-type-general"style="border-color: rgb(228, 64, 87); width:100%">
                                                    {%elif key == 'P'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(81, 120, 211)">
                                                    {%else%} 
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(64, 228, 206)">
                                                    {%endif%} 
                                                    
                                                        <div onclick="filtre_llista('tipus=','{{key}}')" class="name">{{value}}</div>
                                                    
                                                    <span class="number"></span>
                                                    </button>
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Gravetat-->
                                        <button class="filters-cat-single" id="categoria_filtre_gravetat" name = "obre"onclick="filtre_tipus('filtre_gravetat')">
                                            <span>Gravetat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_gravetat_selected" onclick="filtre_tipus('filtre_gravetat')" style="display:none">
                                            <span>Gravetat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_gravetat">
                                            <div>
                                                {%for key,value in TGravetat%}
                                                {%if key not in request.GET.gravetat%}
                                                <p>{{request.GET.gravetat}}</p>
                                                    {%if key == 'D'%}
                                                        <button class="single-filter single-filter-type-general"style="border-color: rgb(112, 114, 143); width:100%">
                                                    {%elif key == 'M'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(64, 168, 228);">
                                                    {%elif key == 'N'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(64, 228, 124);">
                                                    {%elif key == 'I'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(228, 162, 64);">
                                                    {%else%} 
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(211, 84, 80);">
                                                    {%endif%} 
                                                    
                                                    <div onclick="filtre_llista('gravetat=','{{key}}')" class="name">{{value}}</div>
                                                    </button>
                                                    {%endif%}
                                                {%endfor%}  
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Prioritat-->
                                        <button class="filters-cat-single" id="categoria_filtre_prioritat" name = "obre"onclick="filtre_tipus('filtre_prioritat')">
                                            <span>Prioritat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_prioritat_selected" onclick="filtre_tipus('filtre_prioritat')" style="display:none">
                                            <span>Prioritat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_prioritat">
                                            <div>
                                                {%for key,value in TPrioritat%}
                                                {%if ke not in request.GET.prioritat%}
                                                {%if key == 'B'%}
                                                        <button class="single-filter single-filter-type-general"style="border-color: rgb(168, 228, 64); width:100%">
                                                {%elif key == 'M'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(228, 206, 64);">
                                                {%else%} 
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(228, 124, 64);">
                                                {%endif%} 
                                                    <div onclick="filtre_llista('prioritat=','{{key}}')" class="name">{{value}}</div>
                                                    </button>
                                                {%endif%}
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Estat-->
                                        <button class="filters-cat-single" id="categoria_filtre_estat" name = "obre"onclick="filtre_tipus('filtre_estat')">
                                            <span>Estat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_estat_selected" onclick="filtre_tipus('filtre_estat')" style="display:none">
                                            <span>Estat</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_estat">
                                            <div>
                                                {%for key,value in TEstats%}
                                                    {%if key == 'N'%}
                                                        <button class="single-filter single-filter-type-general"style="border-color: rgb(112, 114, 143);; width:100%">
                                                    {%elif key == 'D'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(64, 168, 228);">
                                                    {%elif key == 'T'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(228, 206, 64);">
                                                    {%elif key == 'C'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(168, 228, 64);">
                                                    {%elif key == 'I'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(228, 64, 87);">
                                                    {%elif key == 'R'%}
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(169, 170, 188);">
                                                    {%else%} 
                                                        <button class="single-filter single-filter-type-general" style="border-color: rgb(81, 120, 211);">
                                                    {%endif%}
                                                    <div onclick="filtre_llista('estat=','{{key}}')" class="name">{{value}}</div>
                                                    </button>
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Assignat-->
                                        <button class="filters-cat-single" id="categoria_filtre_assignat" name = "obre"onclick="filtre_tipus('filtre_assignat')">
                                            <span>Assignat a</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_assignat_selected" onclick="filtre_tipus('filtre_assignat')" style="display:none">
                                            <span>Assignat a</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_assignat">
                                            <div>
                                                {%for usuari in usuaris%}
                                                <button class="single-filter single-filter-type-general" style="border-color: rgb(81, 120, 211);">
                                                    <div onclick="filtre_llista('assignat=','{{usuari.user.username}}')" class="name">{{usuari.user.username}}</div>
                                                    
                                                </button>
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Tags-->
                                        <button class="filters-cat-single" id="categoria_filtre_rol" name = "obre"onclick="filtre_tipus('filtre_rol')">
                                            <span>Tags</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_rol_selected" onclick="filtre_tipus('filtre_rol')" style="display:none">
                                            <span>Tags</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_rol">
                                            <div>
                                                {%for issue in issues%}
                                                {%for tag in issue.tags.all%}
                                                <button class="single-filter single-filter-type-general" style="background-color: {{tag.color}};">
                                                    <div onclick="filtre_llista('tags=','{{tag.nom}}')" class="name">{{tag.nom}}</div>
                                                    
                                                </button>
                                                {%endfor%}
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                    <li><!--Creat-->
                                        <button class="filters-cat-single" id="categoria_filtre_creat" name = "obre"onclick="filtre_tipus('filtre_creat')">
                                            <span>Creat per</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-right" style="fill: cred">
                                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <button class="filters-cat-single selected" name="tanca"id="categoria_filtre_creat_selected" onclick="filtre_tipus('filtre_creat')" style="display:none">
                                            <span>Creat per</span>
                                            <div class="ng-animate-disabled">
                                                <svg class="icon icon-arrow-down" style="fill: cred">
                                                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                </svg>
                                            </div>
                                        </button>
                                        <div class="filter-list" style="display:none" name="tanca"id="filtre_creat">
                                            <div>
                                                {%for usuari in usuaris%}
                                                <button class="single-filter single-filter-type-general" style="border-color: rgb(168, 228, 64);">
                                                    <div onclick="filtre_llista('creat=','{{usuari.user.id}}')" class="name">{{usuari.user.username}}</div>
                                                    
                                                </button>
                                                {%endfor%}
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </sidebar>
                <!--Llistat Issues-->
                <div class="issue-page"style="width: 100%;">
                   <table class="issues-table" style="width: 100%;border-collapse:separate; border-spacing: 0 10px;">
                        <tr class="row title">
                            <td class="level-field">
                                <div style="display:flex; flex-direction: row;">
                                <span class="wide" style="padding-top: 6px;">Tipus</span>
                                <div class="mobile"style="padding-top:6px;">
                                    <span class="first-letter">Tipus</span>
                                </div>
                                
                                <form method="delete" action="{{request.get_full_path}}">
                                    <div name="order_by" value="-tipus">
                                        <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                    </div>
                                    <button type="submit" ></button>
                                </form>
                                <div class ="icon-arrow-down" style="display:flex; flex-direction: column;padding-left: 10px;">
                                    <a href="?order_by=tipus" class="name" onclick=borra(order_by,tipus,request.get_full_path)>
                                    {%if "=tipus" in request.get_full_path%}
                                        <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                    {%else%}
                                        <i class="fa fa-angle-up" aria-hidden="true"></i>
                                    {%endif%}
                                    </a>
                                    <a href="?order_by=-tipus" class="name">
                                    {%if "=-tipus" in request.get_full_path%}
                                        <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                    {%else%}
                                        <i class="fa fa-angle-down" aria-hidden="true"></i>
                                    {%endif%}
                                    </a>
                                </div>
                            </div>
                            </td>
                            <td class="level-field">
                                <div style="display:flex; flex-direction: row;">
                                    <span class="wide"style="padding-top: 6px;">Gravetat</span>
                                    <div class="mobile"style="padding-top:6px;">
                                        <span class="first-letter">Gravetat</span>
                                    </div>
                                    <div style="display:flex;flex-direction: column; padding-left: 10px; ">
                                        <a href="?order_by=gravetat" class="name" onclick=borra(order_by,tipus,request.get_full_path)>
                                            {%if "=gravetat" in request.get_full_path%}
                                                <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                            {%else%}
                                                <i class="fa fa-angle-up" aria-hidden="true"></i>
                                            {%endif%}
                                        </a>
                                        <a href="?order_by=-gravetat" class="name">
                                            {%if "=-gravetat" in request.get_full_path%}
                                                <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                            {%else%}
                                                <i class="fa fa-angle-down" aria-hidden="true"></i>
                                            {%endif%}
                                        </a>
                                    </div>
                                </div>
                            </td>
                            <td class="level-field">
                                <div style="display:flex; flex-direction: row;">
                                <span class="wide"style="padding-top: 6px;">Prioritat</span>
                                <div class="mobile"style="padding-top: 6px;">
                                    <span class="first-letter">Prioritat</span>
                                </div>
                                <div style="display:flex;flex-direction: column; padding-left: 10px;">
                                    <div class="name" onclick="ordernar('d','prioritat')">
                                        {%if "=prioritat" in request.get_full_path%}
                                            <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-up" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                    <div  class="name" onclick="ordenar('up','prioritat')">
                                        {%if "=-prioritat" in request.get_full_path%}
                                            <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                </div>
                            </div>
                            </td>
                            <td class="subject">
                                <div style="display:flex; flex-direction: row;">
                                <span style="padding-top: 6px;">Issue</span>
                                
                                <div style="display:flex;flex-direction: column; padding-left: 10px;">
                                    <div class="name" onclick="ordenar('d','id')">
                                        {%if "=id" in request.get_full_path%}
                                            <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-up" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                    <div class="name" onclick="ordenar('up','id')">
                                        {%if "=-id" in request.get_full_path%}
                                            <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                </div>
                            </div>
                            </td>
                            <td class="issue-field">
                                <div style="display:flex; flex-direction: row;">
                                <span style="padding-top: 6px;">Estat</span>
                                <div style="display:flex;flex-direction: column; padding-left: 10px;">
                                    {%if request.GET.order_by%}
                                    {%endif%}
                                    <div  class="name" onclick="ordenar('d','estat')">
                                        {%if "=estat" in request.get_full_path%}
                                            <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-up" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                    <div class="name" onclick="ordenar('up','estat')">
                                        {%if "=-estat" in request.get_full_path%}
                                            <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        {%endif%}
                                    </div>
                                </div>
                            </div>
                            </td>
                            <td class="modified-field">
                                <div style="display:flex; flex-direction: row;">
                                <span style="padding-top: 6px;">Modificat</span>
                                <div style="display:flex;flex-direction: column; padding-left: 10px;">
                                    <a href="?order_by=dataModificacio" class="name" onclick=borra(order_by,tipus,request.get_full_path)>
                                        {%if "=dataModificacio" in request.get_full_path%}
                                            <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-up" aria-hidden="true"></i>
                                        {%endif%}
                                    </a>
                                    <a href="?order_by=-dataModificacio" class="name">
                                        {%if "=-dataModificacio" in request.get_full_path%}
                                            <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        {%endif%}
                                    </a>
                                </div>
                            </div>
                            </td>
                            <td class="assigned-field">
                                <div style="display:flex; flex-direction: row;">
                                <span style="padding-top: 6px;">Assignat a</span>
                                <div style="display:flex;flex-direction: column; padding-left: 10px;">
                                    <a href="?order_by=assignacio" class="name" onclick=borra(order_by,tipus,request.get_full_path)>
                                        {%if "=assignacio" in request.get_full_path%}
                                            <i class="fa fa-sort-asc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-up" aria-hidden="true"></i>
                                        {%endif%}
                                    </a>
                                    <a href="?order_by=-assignacio" class="name">
                                        {%if "=-assignacio" in request.get_full_path%}
                                            <i class="fa fa-sort-desc" aria-hidden="true"></i>
                                        {%else%}
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        {%endif%}
                                    </a>
                                </div>
                            </div>
                            </td>
                        </tr>
                        {% for issue in issues %}
                        
                            {%if issue.bloquejat %}
                                <tr class="row table-main is-blocked" style="height: 80px;">
                            {%else%}
                                <tr class="row table-main" style="height: 80px;">
                            {%endif%}
                            
                                <td class="level-field" style="padding-left: 20px;padding-right: 20px; text-align: center;
                                vertical-align: middle">
                                        {% if issue.tipus == "B" %}
                                            <div class="level" style="background: rgb(228, 64, 87)"></div>
                                        {%elif issue.tipus == "P"%}
                                            <p class="level" style="background: rgb(81, 120, 211)"></p>
                                        {%elif issue.tipus == "M"%}
                                            <p class="level" style="background:  rgb(64, 228, 206)"></p>
                                        {%endif%}
                                </td>
                                 <td class="level-field" style="padding-right: 20px;text-align: center;
                                 vertical-align: middle;">
                                    {% if issue.gravetat == "D" %}
                                        <div class="level" style="background: rgb(112, 114, 143)"></div>
                                    {%elif issue.gravetat == "M"%}
                                        <p class="level" style="background: rgb(64, 168, 228)"></p>
                                    {%elif issue.gravetat == "N"%}
                                        <p class="level" style="background:  rgb(64, 228, 124)"></p>
                                    {%elif issue.gravetat == "I"%}
                                        <p class="level" style="background:  rgb(228, 162, 64)"></p>
                                    {%elif issue.gravetat == "C"%}
                                        <p class="level" style="background:   rgb(211, 84, 80)"></p>
                                    {%endif%}
                                 </td>
                                 
                                 <td class="level-field" style="padding-right: 20px;text-align: center;
                                 vertical-align: middle;">
                                        {% if issue.prioritat == "B" %}
                                            <p class="level" style="background: rgb(168, 228, 64);"></p>
                                        {%elif issue.prioritat == "M"%}
                                            <p class="level" style=" background: rgb(228, 206, 64);;"></p>
                                        {%elif issue.prioritat == "A"%}
                                            <p class="level" style="background:  rgb(228, 124, 64);"></p>
                                        {%endif%}
                                        
                                </td>
                            
                                <td class="subject" style="text-align: center;
                                vertical-align: middle;">
                                    
                                    <a href="{% url 'editar_issue' issue.id %}" >
                                        <span classe="issue-text" style="display: inline-flex;">
                                            <span class="issue-ref">#{{issue.id}}</span>
                                            <span class="issue-subject">{{issue.subject}}</span>
                                            
                                            {%if issue.bloquejat%}
                                            <div class="blocked">
                                                <i class="fa fa-lock" aria-hidden="true" style="color:red;padding-right: 5px;"></i>
                                            </div>
                                            {%endif%}
                                            {% if issue.dataLimit != null%}
                                            <div class="due-date">
                                                <i class="fa fa-clock-o" aria-hidden="true"></i>
                                            </div>
                                            {%endif%}
                                            <div class="cjt_tags">
                                            {%for tag in issue.tags.all%}
                                            <span id ="tag_show"class="tag" style="padding-right: 5px;background-color: {{tag.color}}; ">{{tag.nom}}</span>
                                            {%endfor%}
                                            </div>
                                        </span>
                                        
                                    </a> 
                                    <div>
                                        
                                        
                                    </div>
                                </td>
                                
                                <td  style="text-align: center;
                                vertical-align: middle;">
                              
                                <form method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id_issue" value="{{issue.id}}">
                                <select id="selectStatus{{issue.id}}" onchange="document.getElementById('btnSaveState{{issue.id}}').click()" name="estat" type="submit" class="status-button" style="margin-top: 5px; border:none; outline:none;background: none;">
                                    {% for key,value in TEstats %}
                                        {% if issue.estat == key %}
                                            <option selected="selected" value="{{key}}">{{value}}</option>
                                        {%else %}
                                            <option value="{{key}}">{{value}}</option>
                                        {%endif%}
                                    {% endfor %}
                                </select>
                                <button id="btnSaveState{{issue.id}}" type="submit"  name="guardar_estat" style="display: none;"></button>
                                </form>
                                </td>
                                
                                <td class="modified-field" style="text-align: center;
                                vertical-align: middle;">
                                    <span>{{issue.dataModificacio}}</span>
                                    
                                </td>
                                
                                <td class="assigned-field" style="text-align: center;
                                vertical-align: middle;">   
                                <form method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id_issue" value="{{issue.id}}">
                                    <select id="selectAssig{{issue.id}}" onchange="document.getElementById('btnSaveAssig{{issue.id}}').click() "name="assignat" type="submit" class="assigned-button" style="margin-top: 5px; border:none; outline:none;background: none;">
                                        <option value="0">no avatar</option>
                                        {% for usuari in usuaris %}
                                            
                                                <option value="{{usuari.user.id}}">{{usuari.user.username}}</option>
                                            
                                        {% endfor %}
                                    </select>
                                    <button id="btnSaveAssig{{issue.id}}" type="submit"  name="guardar_assignat" style="display: none;"></button>
                                    </form>
                                    <img class="issue-assignedto">{{issue.assignacio.user.avatar.url}}</img>
                                </td>
                                
                                
                            </tr> 
                        {% endfor %}

                    </table>
                </div>
            </div>
</div>
</div>

    
<script type="text/javascript">
    
   function ordenar(param1,value){
    var url = window.location.href
    
        if(param1=='up'){
            window.location.href = url.replace('order_by='+value, 'order_by=-'+ value)
        }
        else{
            window.location.href = url.replace('order_by=-'+value, 'order_by='+value)
        }
   }
    
    
    
    
    function filtre(val1,val2){
        
        var x = document.getElementById(val2).value;
        console.log(x)
       if(window.location.href.length == 29){
        console.log(window.location.href);
        window.location.href = window.location.href+"?"+val1 +x;
       }
       else if(window.location.href.includes(val1)){
        window.location.href = url.replace(val1 , val1 + x+",")
        var url =window.location.href;
        var num =url.indexOf(val1);
        console.log(num)
       }
       else{
        window.location.href= window.location.href+"&"+val1+x;
       }
    }
    function filtre_llista(val1,val2){
     
       if(window.location.href.length == 29){
        console.log(window.location.href);
        window.location.href = window.location.href+"?"+val1 +val2;
       }
       else if(window.location.href.includes(val1)){
        var url =window.location.href;
        window.location.href = url.replace(val1 , val1 + val2+",")
        
        var num =url.indexOf(val1);
        console.log(num)
       }
       else{
        window.location.href= window.location.href+"&"+val1+val2;
       }
    }
    
    function borra() {
        var querystring = window.location.href;
        console.log(querystring);
        const params = new URLSearchParams(querystring)
        var aa= params.get('estat');
        console.log(params.has('estat'));
        
    }
    function toggle(){
        var x = document.getElementById("tag_on");
        var p = document.getElementById("tag_off");
        var z = document.querySelectorAll('[class="cjt_tags"]');
        
        
        if (x.style.display === "none") {
            x.style.display = "block";
            p.style.display = "none";
            for(i=0;i<z.length;i++){
            z[i].style.display="block";
            }
        } else {
         x.style.display = "none";
         p.style.display ="block";
         for(i=0;i<z.length;i++){
            z[i].style.display="none";
            }
        }
    }
    
    function myFunction() {
        
        var x = document.getElementById("filtres");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
         x.style.display = "none";
        }
    }

    function tanca_tot(param1){
        var tanca = document.getElementsByName("tanca");
        for(var i = 0; i < tanca.length; i++){
            if(tanca[i].id != param1)
            tanca[i].style.display= "none"; 
        }
        var obre = document.getElementsByName("obre");
        for(var i = 0; i < obre.length; i++){
            if(obre[i].id != param1)
            obre[i].style.display= "flex"; 
        }
    }

    function filtre_tipus(param1) {
        if(param1 == "filtre_tipus"){
            var x = document.getElementById("filtre_tipus");
            var y = document.getElementById("categoria_filtre_tipus");
            var z = document.getElementById("categoria_filtre_tipus_selected")
        }
        if(param1 == "filtre_gravetat"){
            var x = document.getElementById("filtre_gravetat");
            var y = document.getElementById("categoria_filtre_gravetat");
            var z = document.getElementById("categoria_filtre_gravetat_selected")
        }
        if(param1 == "filtre_prioritat"){
            var x = document.getElementById("filtre_prioritat");
            var y = document.getElementById("categoria_filtre_prioritat");
            var z = document.getElementById("categoria_filtre_prioritat_selected")
        }
        if(param1 == "filtre_estat"){
            var x = document.getElementById("filtre_estat");
            var y = document.getElementById("categoria_filtre_estat");
            var z = document.getElementById("categoria_filtre_estat_selected")
        }
        if(param1 == "filtre_assignat"){
            var x = document.getElementById("filtre_assignat");
            var y = document.getElementById("categoria_filtre_assignat");
            var z = document.getElementById("categoria_filtre_assignat_selected")
        }
        if(param1 == "filtre_rol"){
            var x = document.getElementById("filtre_rol");
            var y = document.getElementById("categoria_filtre_rol");
            var z = document.getElementById("categoria_filtre_rol_selected")
        }
        if(param1 == "filtre_creat"){
            var x = document.getElementById("filtre_creat");
            var y = document.getElementById("categoria_filtre_creat");
            var z = document.getElementById("categoria_filtre_creat_selected")
        }

      
        if (y.style.display === "none") {
            tanca_tot(param1);
            x.style.display = "none";
            y.style.display = "flex";
            z.style.display = "none";
        } else {
            tanca_tot(param1);
            x.style.display = "flex";
            y.style.display = "none";
            z.style.display = "flex";
        }
    }
</script>

{% endblock %}